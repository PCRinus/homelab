# Gatus configuration file
# Documentation: https://github.com/TwiN/gatus

storage:
  type: sqlite
  path: /data/data.db

web:
  port: 8080

debug: false

# Log endpoint evaluation results
# This will log every check result which is useful for monitoring
alerting:
  console:
    enabled: true
  discord:
    webhook-url: "${DISCORD_WEBHOOK_URL}"
    default-alert:
      description: "Service health check failed"
      send-on-resolved: true
      failure-threshold: 3
      success-threshold: 2

endpoints:
  # Media Server Stack
  - name: qBittorrent
    group: Media Server
    url: "http://qbittorrent:8080"
    interval: 60s
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "qBittorrent is down or not responding"

  - name: Sonarr
    group: Media Server
    url: "http://sonarr:8989/api/v3/system/status"
    interval: 60s
    headers:
      X-Api-Key: "${SONARR_API_KEY}"
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "Sonarr is down or not responding"

  - name: Radarr
    group: Media Server
    url: "http://radarr:7878/api/v3/system/status"
    interval: 60s
    headers:
      X-Api-Key: "${RADARR_API_KEY}"
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "Radarr is down or not responding"

  - name: Prowlarr
    group: Media Server
    url: "http://prowlarr:9696/api/v1/system/status"
    interval: 60s
    headers:
      X-Api-Key: "${PROWLARR_API_KEY}"
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "Prowlarr is down or not responding"

  - name: FlareSolverr
    group: Media Server
    url: "http://flaresolverr:8191/health"
    interval: 60s
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "FlareSolverr is down or not responding"

  - name: Overseerr
    group: Media Server
    url: "http://overseerr:5055/api/v1/status"
    interval: 60s
    headers:
      X-Api-Key: "${OVERSEERR_API_KEY}"
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "Overseerr is down or not responding"

  - name: Bazarr
    group: Media Server
    url: "http://bazarr:6767/api/system/status"
    interval: 60s
    headers:
      X-Api-Key: "${BAZARR_API_KEY}"
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "Bazarr is down or not responding"

  - name: Plex
    group: Media Server
    url: "http://plex:32400/web"
    interval: 60s
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "Plex Media Server is down or not responding"

  - name: Jellyfin
    group: Media Server
    url: "http://jellyfin:8096/health"
    interval: 60s
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "Jellyfin Media Server is down or not responding"

  - name: Home Assistant
    group: Home Automation
    url: "http://host.docker.internal:8123"
    interval: 60s
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 1000"
    alerts:
      - type: discord
        description: "Home Assistant is down or not responding"

  # Infrastructure
  - name: Cloudflare Tunnel
    group: Infrastructure
    url: "http://cloudflared:20241/metrics"
    interval: 60s
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 500"
    alerts:
      - type: discord
        description: "Cloudflare Tunnel is down - external access may be unavailable"
        failure-threshold: 5

  - name: Dozzle
    group: Infrastructure
    url: "http://dozzle:8080"
    interval: 60s
    conditions:
      - "[STATUS] == 200"
      - "[RESPONSE_TIME] < 500"
    alerts:
      - type: discord
        description: "Dozzle (log viewer) is down or not responding"
