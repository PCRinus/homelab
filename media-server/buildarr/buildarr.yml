---
# Buildarr configuration for managing *arr stack
# Version controlled in git repository

# Include secrets file (not version controlled)
includes:
  - buildarr-secrets.yml

buildarr:
  # Watch the configuration file for changes and apply them automatically
  watch_config: true
  
  # Update schedule - daily at 3 AM
  update_days:
    - "monday"
    - "tuesday"
    - "wednesday"
    - "thursday"
    - "friday"
    - "saturday"
    - "sunday"
  update_times:
    - "03:00"

# Sonarr configuration
sonarr:
  instances:
    sonarr:
      host: "sonarr"
      port: 8989
      protocol: "http"
      # API key defined in buildarr-secrets.yml
      settings:
        # === MEDIA MANAGEMENT ===
        media_management:
          # Root folder for TV shows - TRaSH recommended path
          root_folders:
            - /data/media/tv
          # Enable hardlinks for instant moves (requires same filesystem)
          use_hardlinks: true
          # TRaSH recommended naming scheme
          rename_episodes: true
          replace_illegal_characters: true
          standard_episode_format: '{Series TitleYear} - S{season:00}E{episode:00} - {Episode CleanTitle} [{Quality Full}]{[MediaInfo VideoDynamicRangeType]}{[Mediainfo AudioCodec}{ Mediainfo AudioChannels]}{[MediaInfo VideoCodec]}{-Release Group}'
          daily_episode_format: '{Series TitleYear} - {Air-Date} - {Episode CleanTitle} [{Quality Full}]{[MediaInfo VideoDynamicRangeType]}{[Mediainfo AudioCodec}{ Mediainfo AudioChannels]}{[MediaInfo VideoCodec]}{-Release Group}'
          anime_episode_format: '{Series TitleYear} - S{season:00}E{episode:00} - {absolute:000} - {Episode CleanTitle} [{Quality Full}]{[MediaInfo VideoDynamicRangeType]}[{MediaInfo VideoBitDepth}bit]{[MediaInfo VideoCodec]}[{Mediainfo AudioCodec} { Mediainfo AudioChannels}]{MediaInfo AudioLanguages}{-Release Group}'
          series_folder_format: '{Series TitleYear} [tvdbid-{TvdbId}]'
          season_folder_format: 'Season {season:00}'
          specials_folder_format: 'Specials'
          multiepisode_style: prefixed-range
        
        # NOTE: Download clients managed manually in Sonarr UI
        # Buildarr has a SecretStr serialization bug when updating passwords

# Radarr configuration
# NOTE: Disabled due to Buildarr Radarr plugin v0.2.6 incompatibility with Radarr v6
# The plugin fails to deserialize Radarr v6 API responses (colonReplacementFormat enum changed)
# See: https://github.com/buildarr/buildarr-radarr/issues
# Uncomment when plugin is updated to support Radarr v6
# radarr:
#   instances:
#     radarr:
#       host: "radarr"
#       port: 7878
#       protocol: "http"
#       # API key defined in buildarr-secrets.yml
#       settings:
#         download_clients:
#           enable_completed_download_handling: true
#           redownload_failed: true
#           definitions:
#             qBittorrent:
#               type: qbittorrent
#               enable: true
#               hostname: qbittorrent
#               port: 8080
#               username: admin
#               category: radarr

# Prowlarr configuration
prowlarr:
  instances:
    prowlarr:
      host: "prowlarr"
      port: 9696
      protocol: "http"
      # API key defined in buildarr-secrets.yml
      settings:
        # === INDEXERS ===
        indexers:
          # Don't delete indexers not defined here (allows manual additions)
          indexers:
            delete_unmanaged: false
            definitions:
              1337x:
                type: 1337x
                enable: true
                sync_profile: Standard
                priority: 25
                tags:
                  - flaresolverr
                fields:
                  downloadlink: iTorrents.org
                  downloadlink2: magnet
                  sort: created
                  type: desc
              
              BitSearch:
                type: bitsearch
                enable: true
                sync_profile: Standard
                priority: 25
              
              "FileList.io":
                type: filelist.io
                enable: true
                sync_profile: Standard
                priority: 25
                query_limit: 150  # Private tracker - respect rate limits
                fields:
                  baseUrl: https://filelist.io/
                  username: PCRinus
                  # passkey is in secret_fields, managed via UI
                  freeleechOnly: false
              
              Isohunt2:
                type: isohunt2
                enable: true
                sync_profile: Standard
                priority: 25
                fields:
                  category: All
                  sort: created
              
              "kickasstorrents.to":
                type: kickasstorrents-to
                enable: true
                sync_profile: Standard
                priority: 25
                tags:
                  - flaresolverr
          
          # FlareSolverr proxy for cloudflare-protected sites
          proxies:
            delete_unmanaged: false
            definitions:
              FlareSolverr:
                type: flaresolverr
                host_url: http://flaresolverr:8191
                request_timeout: 60
                tags:
                  - flaresolverr
        
        # === APPLICATIONS (Sonarr/Radarr sync) ===
        apps:
          applications:
            delete_unmanaged: false
            definitions:
              Sonarr:
                type: sonarr
                prowlarr_url: http://prowlarr:9696
                base_url: http://sonarr:8989
                sync_level: full-sync
                sync_categories:
                  - tv/uhd
                  - tv/hd
                  - tv
                  - tv/web-dl
                  - tv/other
                  - tv/x265
                  - tv/foreign
                  - tv/sd
                anime_sync_categories:
                  - tv/anime
                sync_anime_standard_format_search: true
                tags: []
              
              Radarr:
                type: radarr
                prowlarr_url: http://prowlarr:9696
                base_url: http://radarr:7878
                sync_level: full-sync
                sync_categories:
                  - movies/foreign
                  - movies/x265
                  - movies/web-dl
                  - movies/sd
                  - movies/hd
                  - movies/other
                  - movies/3d
                  - movies/dvd
                  - movies/bluray
                  - movies/uhd
                  - movies
                tags: []
          
          # Sync profile used by indexers
          sync_profiles:
            delete_unmanaged: false
            definitions:
              Standard:
                enable_rss: true
                enable_interactive_search: true
                enable_automatic_search: true
                minimum_seeders: 1
        
        # === TAGS ===
        tags:
          definitions:
            - flaresolverr
        
        # === SETTINGS YOU PROBABLY DON'T NEED TO MANAGE ===
        # These are typically set once and rarely changed:
        
        # general:
        #   host:
        #     instance_name: Prowlarr
        #     # port, bind_address - managed via Docker
        #   security:
        #     authentication: form
        #     authentication_required: enabled
        #     # username/password - better managed via UI for security
        #   logging:
        #     log_level: DEBUG
        #   backup:
        #     interval: 7
        #     retention: 28
        
        # ui:
        #   first_day_of_week: sunday
        #   time_format: twelve-hour
        #   theme: auto
